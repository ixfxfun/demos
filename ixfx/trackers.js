import{v as e}from"./src-DdJCbM4z.js";import{t}from"./simple-event-emitter-DdjYDCSw.js";import{t as n}from"./number-array-compute-BHNf8OQn.js";import{t as r}from"./tracker-base-B9GTo4Nh.js";import{n as i,r as a,t as o}from"./number-tracker-CTnA67yJ.js";import{t as s}from"./timeout-BnV_k5ts.js";import{n as c,t as l}from"./tracked-value-BJVpL2jS.js";function u(e,t,n){return r=>{let i=e(r);i.changed?t(r,i.changes,i.total):n!==void 0&&n(r,i.identicalRun,i.total)}}function d(e={}){let t=e.nanHandling??`error`,n=e.includeFirstValueInCount??!1,r=e.initial,i=0,a=0,o=0;return e=>{if(typeof e!=`number`)throw TypeError(`Parameter should be number. Got type: ${typeof e}`);if(Number.isNaN(e))switch(t){case`error`:throw Error(`Parameter is NaN`);case`skip`:return{changed:!1,changes:i,total:a,identicalRun:o}}a++;let s=r===e;if(Number.isNaN(r)&&Number.isNaN(e)&&(s=!0),s)o++;else return o=0,(r!==void 0||n)&&i++,r=e,{changed:!0,changes:i,total:a,identicalRun:o};return{changed:!1,changes:i,total:a,identicalRun:o}}}function f(e={}){let t=e.includeFirstValueInCount??!1,n=e.initial,r=0,i=0,a=0;return e=>{if(typeof e!=`boolean`)throw TypeError(`Parameter should be boolean. Got type: ${typeof e}`);return i++,n===e?(a++,{changed:!1,changes:r,total:i,identicalRun:a}):(a=0,(n!==void 0||t)&&r++,n=e,{changed:!0,changes:r,total:i,identicalRun:a})}}var p=class{ft;sources=new Set;constructor(e){this.ft=new m(e)}add(e,t){this.sources.has(t)||(this.sources.add(t),this.ft.add(e))}clear(){this.ft.clear(),this.sources.clear()}},m=class extends t{#e;#t;#n;constructor(e){super(),this.#e=new Map,e===void 0&&(e=e=>{if(e===void 0)throw Error(`Cannot create key for undefined`);return typeof e==`string`?e:JSON.stringify(e)}),this.#t=e}clear(){this.#e.clear(),this.#n=void 0,this.fireEvent(`change`,{context:this})}keys(){return this.#e.keys()}values(){return this.#e.values()}toArray(){return[...this.#e.entries()]}debugString(){let e=``;for(let[t,n]of this.#e.entries())e+=`${t}: ${n.toString()}, `;return e.endsWith(`, `)?e.slice(0,Math.max(0,e.length-2)):e}frequencyOf(e){if(typeof e==`string`)return this.#e.get(e);let t=this.#t(e);return this.#e.get(t)}relativeFrequencyOf(e){let t;if(typeof e==`string`)t=this.#e.get(e);else{let n=this.#t(e);t=this.#e.get(n)}if(t===void 0)return;let n=this.computeValues();return t/n.total}*entries(){yield*this.#e.entries()}*filterByTally(e){for(let t of this.#e.entries())e(t[1])&&(yield t)}*filterByRelativeTally(e){let t=this.computeValues().total;for(let n of this.#e.entries())e(n[1]/t)&&(yield n)}computeValues(){return this.#n||=n([...this.values()]),this.#n}entriesSorted(t=`value`){return e(t)([...this.entries()])}add(...e){if(e===void 0)throw Error(`Param 'values' undefined`);this.#n=void 0;let t=e.map(e=>this.#t(e));for(let e of t){let t=this.#e.get(e)??0;this.#e.set(e,t+1)}this.fireEvent(`change`,{context:this})}};const h=e=>new m(e);var g=class extends o{lastMark=0;mark(){this.lastMark>0&&this.seen(performance.now()-this.lastMark),this.lastMark=performance.now()}};const _=e=>new g(e);var v=class{#e=[];#t;#n;#r;#i;constructor(e={}){this.#n=e.resetAfterSamples??2**53-1,this.#r=e.sampleLimit??2**53-1,e.timeoutInterval&&(this.#i=s(()=>{this.reset()},e.timeoutInterval)),this.#t=performance.now()}mark(){this.#e.length>=this.#n?this.reset():this.#e.length>=this.#r&&(this.#e=this.#e.slice(1),this.#t=this.#e[0]),this.#e.push(performance.now()),this.#i&&this.#i.start()}computeIntervals(){let e=[],t=2**53-1,n=-(2**53-1),r=0,i=0,a=0;for(let o of this.#e){if(i>0){let i=o-a;t=Math.min(i,t),n=Math.max(i,n),r+=i,e.push(i)}a=o,i++}let o=r/i;return{min:t,max:n,avg:o}}get elapsed(){return performance.now()-this.#t}reset(){this.#e=[],this.#t=performance.now()}get perSecond(){return this.#e.length/(this.elapsed/1e3)}get perMinute(){return this.#e.length/(this.elapsed/1e3/60)}};const y=(e={})=>new v(e);export{m as FrequencyTracker,p as GatedFrequencyTracker,g as IntervalTracker,o as NumberTracker,c as ObjectTracker,a as PrimitiveTracker,v as RateTracker,l as TrackedValueMap,r as TrackerBase,h as frequency,u as handleChangeResult,_ as interval,i as number,y as rate,f as trackBooleanChange,d as trackNumberChange};