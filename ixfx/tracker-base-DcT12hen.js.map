{"version":3,"file":"tracker-base-DcT12hen.js","names":[],"sources":["../../trackers/dist/src/tracker-base.js"],"sourcesContent":["/**\n * Base tracker class\n */\nexport class TrackerBase {\n    /**\n     * @ignore\n     */\n    seenCount;\n    /**\n     * @ignore\n     */\n    storeIntermediate;\n    /**\n     * @ignore\n     */\n    resetAfterSamples;\n    /**\n     * @ignore\n     */\n    sampleLimit;\n    id;\n    debug;\n    constructor(opts = {}) {\n        this.id = opts.id ?? `tracker`;\n        this.debug = opts.debug ?? false;\n        this.sampleLimit = opts.sampleLimit ?? -1;\n        this.resetAfterSamples = opts.resetAfterSamples ?? -1;\n        this.storeIntermediate =\n            opts.storeIntermediate ??\n                (this.sampleLimit > -1 || this.resetAfterSamples > -1);\n        this.seenCount = 0;\n        if (this.debug) {\n            console.log(`TrackerBase: sampleLimit: ${this.sampleLimit} resetAfter: ${this.resetAfterSamples} store: ${this.storeIntermediate}`);\n        }\n    }\n    /**\n     * Reset tracker\n     */\n    reset() {\n        this.seenCount = 0;\n        this.onReset();\n    }\n    /**\n     * Adds a value, returning computed result.\n     *\n     * At this point, we check if the buffer is larger than `resetAfterSamples`. If so, `reset()` is called.\n     * If not, we check `sampleLimit`. If the buffer is twice as large as sample limit, `trimStore()` is\n     * called to take it down to sample limit, and `onTrimmed()` is called.\n     * @param p\n     * @returns\n     */\n    seen(...p) {\n        if (this.resetAfterSamples > 0 && this.seenCount > this.resetAfterSamples) {\n            this.reset();\n        }\n        else if (this.sampleLimit > 0 && this.seenCount > this.sampleLimit * 2) {\n            this.seenCount = this.trimStore(this.sampleLimit);\n            this.onTrimmed(`resize`);\n        }\n        this.seenCount += p.length;\n        const t = this.filterData(p);\n        return this.computeResults(t);\n    }\n}\n"],"mappings":";;;;AAGA,IAAa,cAAb,MAAyB;;;;CAIrB;;;;CAIA;;;;CAIA;;;;CAIA;CACA;CACA;CACA,YAAY,OAAO,CAAE,GAAE;EACnB,KAAK,KAAK,KAAK,MAAM,CAAC,OAAO,CAAC;EAC9B,KAAK,QAAQ,KAAK,SAAS;EAC3B,KAAK,cAAc,KAAK,eAAe;EACvC,KAAK,oBAAoB,KAAK,qBAAqB;EACnD,KAAK,oBACD,KAAK,sBACA,KAAK,cAAc,MAAM,KAAK,oBAAoB;EAC3D,KAAK,YAAY;AACjB,MAAI,KAAK,OACL,QAAQ,IAAI,CAAC,0BAA0B,EAAE,KAAK,YAAY,aAAa,EAAE,KAAK,kBAAkB,QAAQ,EAAE,KAAK,mBAAmB,CAAC;CAE1I;;;;CAID,QAAQ;EACJ,KAAK,YAAY;EACjB,KAAK,SAAS;CACjB;;;;;;;;;;CAUD,KAAK,GAAG,GAAG;AACP,MAAI,KAAK,oBAAoB,KAAK,KAAK,YAAY,KAAK,mBACpD,KAAK,OAAO;WAEP,KAAK,cAAc,KAAK,KAAK,YAAY,KAAK,cAAc,GAAG;GACpE,KAAK,YAAY,KAAK,UAAU,KAAK,YAAY;GACjD,KAAK,UAAU,CAAC,MAAM,CAAC,CAAC;EAC3B;EACD,KAAK,aAAa,EAAE;EACpB,MAAM,IAAI,KAAK,WAAW,EAAE;AAC5B,SAAO,KAAK,eAAe,EAAE;CAChC;AACJ"}