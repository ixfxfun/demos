{"version":3,"file":"dispatch-list-5GN8t8ns.js","names":["#id","#handlers","handler: Dispatch<V>","options: { once?: boolean }","#counter","wrap: Wrap<V>","id: string","value: V"],"sources":["../../packages/flow/src/dispatch-list.ts"],"sourcesContent":["export type Dispatch<V> = (value: V) => void;\n\ntype Wrap<V> = {\n  readonly handler: Dispatch<V>\n  readonly id: string\n  readonly once: boolean\n}\n\nexport class DispatchList<V> {\n  #handlers: Wrap<V>[]\n  #counter = 0;\n  readonly #id = Math.floor(Math.random() * 100);\n  constructor() {\n\n    this.#handlers = [];\n  }\n\n  /**\n   * Returns _true_ if list is empty\n   * @returns \n   */\n  isEmpty() {\n    return this.#handlers.length === 0;\n  }\n\n  /**\n   * Adds a handler\n   * @param handler \n   * @param options \n   * @returns \n   */\n  add(handler: Dispatch<V>, options: { once?: boolean } = {}): string {\n    this.#counter++;\n    const once = options.once ?? false;\n    const wrap: Wrap<V> = {\n      id: `${ this.#id } - ${ this.#counter }`,\n      handler,\n      once\n    }\n    this.#handlers.push(wrap);\n    return wrap.id;\n  }\n\n  remove(id: string): boolean {\n    const length = this.#handlers.length;\n    this.#handlers = this.#handlers.filter(handler => handler.id !== id);\n    return this.#handlers.length !== length;\n  }\n\n  notify(value: V) {\n    for (const handler of this.#handlers) {\n      handler.handler(value);\n      if (handler.once) {\n        this.remove(handler.id);\n      }\n    }\n  }\n\n  clear() {\n    this.#handlers = [];\n  }\n}"],"mappings":";AAQA,IAAa,eAAb,MAA6B;CAC3B;CACA,WAAW;CACX,AAASA,MAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,IAAI;CAC9C,cAAc;AAEZ,OAAKC,YAAY,CAAE;CACpB;;;;;CAMD,UAAU;AACR,SAAO,KAAKA,UAAU,WAAW;CAClC;;;;;;;CAQD,IAAIC,SAAsBC,UAA8B,CAAE,GAAU;AAClE,OAAKC;EACL,MAAM,OAAO,QAAQ,QAAQ;EAC7B,MAAMC,OAAgB;GACpB,KAAK,EAAG,KAAKL,IAAK,KAAM,KAAKI,SAAU;GACvC;GACA;EACD;AACD,OAAKH,UAAU,KAAK,KAAK;AACzB,SAAO,KAAK;CACb;CAED,OAAOK,IAAqB;EAC1B,MAAM,SAAS,KAAKL,UAAU;AAC9B,OAAKA,YAAY,KAAKA,UAAU,OAAO,aAAW,QAAQ,OAAO,GAAG;AACpE,SAAO,KAAKA,UAAU,WAAW;CAClC;CAED,OAAOM,OAAU;AACf,OAAK,MAAM,WAAW,KAAKN,WAAW;AACpC,WAAQ,QAAQ,MAAM;AACtB,OAAI,QAAQ,KACV,MAAK,OAAO,QAAQ,GAAG;EAE1B;CACF;CAED,QAAQ;AACN,OAAKA,YAAY,CAAE;CACpB;AACF"}